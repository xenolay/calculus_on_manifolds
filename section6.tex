\section{微分可能多様体}

微分可能多様体を定義し，前節に定義したベクトル場や微分形式，Stokes の定理を微分可能多様体にまで拡張する．微分可能多様体に対する Stokes の定理が，古典ベクトル解析における大定理たちを系として持つことを証明する．

\subsection{多様体の定義}

$k$次元多様体とは，大雑把に言ってしまえば「局所的に$\Real^k$と同一視できる空間」である．それを厳密な形で述べることからはじめる．

\begin{defi}
$M \subset \Real^n$の各点$p$が次の条件を充たすとき，$M$は$k$次元（微分可能）多様体であると言われる；$p$を含む開集合$U_p \subset \Real^n$，および開集合$V_p \subset \Real^n$ならびに微分同相写像$h_p \colon U_p \to V_p$が存在して，$h_p(U_p \cap M) = V_p \cap \left(\Real^k \times \set{0}\right)$，すなわち$h_p(U_p \cap M) = \set{y \in V_p | y^{k+1} = \dots = y^n = 0}$が成り立つ．
\end{defi}

\begin{exm}
自明な$k$次元微分可能多様体の例は$\Real^k$の開集合である．もう少し自明でない例として，$k$次元球面$\Sphere^k \coloneqq \set{p \in \Real^{k+1} | \|p\|=1}$がある．これが微分可能多様体であることを見たければ，上記の条件を直接確かめればよい．のだが，面倒なのでまだノートに書き起こしていない．
\end{exm}

ここに「面倒」と書いたが，$\Real^n$の部分集合が多様体であるかどうか，もっとかんたんに判定できる場合がある；

\begin{prop}
$A \subset \Real^n$を開集合，$g \colon A \to \Real^p$を$C^\infty$級関数とする．更に，$g(p)=0$となるような$p \in A$において，$g$の Jacobi 行列の階数が$k$であったと仮定する．このとき，$M \coloneqq g^{-1}(0)$は$n-k$次元多様体である．
\end{prop}

\begin{proof}
\cref{陰関数定理の言い換え}より，各点$p \in g(M)$に対して，$g(p)$を含む開集合$U_p$上で定義された微分同相$F_p \colon U_p \to \Real^n$であって，$g \circ {F_p}^{-1} (p) = (p^{n-k+1}, \dots, p^n)$を充たすようなものがある．$F_p(U_p) \coloneqq V_p$と置く．$F_p \colon U_p \to V_p$が，定義の条件にあるような微分同相写像であること，すなわち$F_p(U_p \cap M) = V_p \cap \left( \Real^{n-k} \times \set{0} \right)$を示せばよい．

$F_p(U_p \cap M) \subset V_p \cap \left( \Real^{n-k} \times \set{0} \right)$を示すために，$q \in U_p \cap M$を任意に取って$r \coloneqq F_p(q)$と置く．$r \in V_p$はよい．$g \circ {F_p}^{-1}(r) = g(p) = 0$なので，$r^{n-p+1} = \dots = r^n = 0$，すなわち$r \in \Real^{n-k} \times \set{0}$がわかる．

逆の包含を示すために$r \in V_p \cap \left( \Real^{n-k} \times \set{0} \right)$を取る．${F_p}^{-1}(r) \in U_p$はよい．$g \circ {F_p}^{-1}(r)=0$なので${F_p}^{-1}(r) \in M$である．
\end{proof}

この命題によって$\Sphere^n$が$n$次元多様体となることがすぐわかる．というのも，$g \colon \Real^{n+1} \to \Real$を$g(p) \coloneqq \|p\|^2 - 1$によって定めれば，$g$は$p \in \Sphere^n$において微分が消えておらず，したがってこの命題の前件を充たすとわかるからである．

さて，もう一つ定義と同値な条件を述べておこう．ベクトル場や微分形式を多様体の上で定義するには，こちらの条件のほうが使いやすい．

\begin{thm}
$M \subset \Real^n$が$k$次元多様体であることと，$M$の各点$p$が次の条件（座標条件と呼ばれる）を充たすことは同値である；$p$を含む開集合$U_p \subset \Real^n$ならびに開集合$W_p \subset \Real^k$，単射な$C^\infty$級関数$f \colon W_p \to \Real^n$が存在して，
\begin{enumerate}
\item $f(W_p) = M \cap U_p$．
\item $W_p$の各点$q$において，$f$の Jacobi 行列$J_f(q)$の階数は$k$．
\item $f^{-1} \colon f(W_p) \to W_p$は連続．
\end{enumerate}
\end{thm}

\begin{proof}
$M$が$k$次元多様体であったとする．$p \in M$を任意に取れば，定義にあるような微分同相$h_p \colon U_p \to V_p$が存在する．このとき，$W_p \coloneqq \set{(b^1, \dots, b^k) | b \in V_p \cap (\Real^k \times \set{0})}$として，$f \colon W_p \to \Real^n$を$f(a) \coloneqq {h_p}^{-1}(a,0)$で定める．$h_p$が$C^\infty$級微分同相であることから$f$の単射性と$C^\infty$級であることがわかる．$W_p \subset \Real^k$が開集合であることはよく，$(a,0) \in V_p \cap (\Real^k \times \set{0})$なので$f(a) = {h_p}^{-1}(a,0) \in U_p \cap M$である．更に$f^{-1} = h_p|_{f(W_p)}$なので（連続関数の制限は常に連続なのだから）$f^{-1}$は連続である．最後に，関数$H_p \colon \Real^n \to \Real^k$を$H_p(a) \coloneqq ({h_p}^1(a), \dots, {h_p}^k(a))$によって定めれば，$H_p$は微分可能であり，更に$H_p(f(q))=q$を充たす．したがって Jacobi 行列を考えることで$J_{H_p}(f(q)) \cdot J_f(q) = I_k$がわかるので，特に$J_f(q)$の階数は$k$である．

逆に$M$の各点が座標条件を充たすと仮定する．$p \in M$を任意に取れば，座標条件にあらわれる関数$f \colon W_p \to \Real^n$が存在する．$p = f(q)$によって$q \in \Real^k$を定める．関数$g \colon W_p \times \Real^{n-k} \to \Real^n$を，$g(a,b) \coloneqq f(a) + (0,b)$で定めると，$\det D_g(q,0) = \det D_f(q) \neq 0$であることから，逆関数定理より$(q,0)$を含む開集合$V'$ならびに$p$を含む開集合$U'$が存在して，$g$は$V'$上で$C^\infty$級の逆写像$h_p \colon U' \to V'$を持つ．また，$f$が座標条件を充たすことから，$\set{f(a) | (a,0) \in V' } = U'' \cap M$を充たす開集合$U''$が存在する\footnote{この部分は行間が大きいと思うが，本文に組み込むと議論の見通しが悪くなるので脚注で補う；座標条件の (i) より，$f(W_p) = U_1 \cap M$となるような開集合$U_1$がある．更に座標条件の (iii) より$f^{-1}$は連続であるから，$W' \coloneqq \set{ a | (a,0) \in V'}$は開集合であることとあわせれば\cref{開集合の引き戻しは開集合}より$\set{f(a) | (a,0) \in V' } = f(W') = U_2 \cap f(W_p)$となるような開集合$U_2$がある．$U'' \coloneqq U_1 \cap U_2$とすればよい．}．$U_p \coloneqq U' \cap U''$，$V_p \coloneqq g^{-1}(U_p)$とする．このとき，$U_p \cap M = \set{ f(a) | (a,0) \in V_p} = \set{ g(a,0) | (a,0) \in V_p}$なので\footnote{この部分も行間があるので補う．2つ目の等号はよいと思うので，$U_p \cap M = \set{ g(a,0) | (a,0) \in V_p}$を示す．$V_p \subset V'$なので，$ \set{ g(a,0) | (a,0) \in V_p} \subset  \set{ g(a,0) | (a,0) \in V'} = U'' \cap M$であり，かつ$\set{ g(a,0) | (a,0) \in V_p} \subset g(V') = U'$であるから，$\set{ g(a,0) | (a,0) \in V_p} \subset U' \cap U'' \cap M = U_p \cap M$である．逆の包含を示すために$p \in U_p \cap M$を取る．$p \notin \set{ g(a,0) | (a,0) \in V_p}$であったとすると，$p \in \set{ g(a,0) | (a,0) \in V'}$なので，結局$p \in \set{ g(a,0) | (a,0) \in V' \setminus V_p}$であることになるが，これは$p \in U_p = g(V_p)$に反する．}，$h_p(U_p \cap M) = g^{-1}(U_p \cap M) = g^{-1}(\set{g(a,0) | (a,0) \in V_p}) = \set{(a,0) | (a,0) \in V_p} = V_p \cap (\Real^k \times \set{0})$である．
\end{proof}

ここに現れた$f \colon W_p \to \Real^n$の逆写像$f^{-1} \colon f(W_p) \to W_p$を，$p$のまわりの座標系という．今後$M$上の座標系を取る場合には，いちいち逆写像を取り直したり定義域を書き下すのが煩雑なので，「$p$のまわりの座標系$f \colon V_p \to \Real^k$」などと，逆写像を持ち出さずに記号を定義し，定義域の宣言も暗黙に済ませることにする．

\begin{exm}
上記の定理における座標条件の (iii) は本質的である．例えば単位開区間$(0,1)$を6の字につないだ図形を考えると，これは1次元多様体ではない．「T字」になっている部分において座標が取れないためである．
\end{exm}

座標条件において，座標系は単に「連続」であることしか課していない（微分可能性を課していない）ので，座標系がたかだか連続でしかない例があるのではないかと思うかもしれないが，実際にはそのようなことはない．証明を見ればわかるように座標系はある微分可能な関数の制限として得られるし，他にも次のようなことが成り立つ．

\begin{prop}
$f_1 \colon V_1 \to \Real^k$並びに$f_2 \colon V_2 \to \Real^k$を$p$のまわりの座標系とする．このとき，$f_2 \circ f_1^{-1} \colon f_1(V_1) \to \Real^k$は$C^\infty$級であり，その Jacobi 行列は正則である．
\end{prop}

\begin{proof}
$f_2$の逆写像を$f' \colon f_2(V_2) \to V_2$とする．このとき，先の定理の証明と同様にして関数$g \colon f_2(V_2) \times \Real^{n-k} \to \Real^n$ならびにその逆写像$h \colon U' \to V'$が取れる．このとき$f_2 = (h^1, \dots, h^k)$であることが以下のようにしてわかる；$a \in f_2(V_2)$を任意に取れば，$f_2 (g(a,0)) = f_2 \circ f'(a) = a$であり，かつ$h \circ g(a,0) = (a,0)$であることと逆写像の一意性から$f_2 = (h^1, \dots, h^k)$である．$f_1^{-1}$の Jacobi 行列の階数が$k$であることと，$h$が微分同相であることをあわせて結論を得る．
\end{proof}

Stokes の定理を多様体に対して拡張するにあたり，ふち付き多様体の概念を導入する必要がある．

\begin{defi}
$\Hyp^k \coloneqq \set{(p^1, \dots, p^k) \in \Real^k | p^k \geq 0}$を半空間という．$M \subset \Real^n$の各点$p$が次の条件のいずれかを充たすとき，$M$は$k$次元ふち付き多様体であると言われる．
\begin{enumerate}
\item $p$を含む開集合$U_p \subset \Real^n$，および開集合$V_p \subset \Real^n$ならびに微分同相写像$h_p \colon U_p \to V_p$が存在して，$h_p(U_p \cap M) = V_p \cap \left(\Real^k \times \set{0}\right)$，すなわち$h_p(U_p \cap M) = \set{y \in V_p | y^{k+1} = \dots = y^n = 0}$が成り立つ．
\item $p$を含む開集合$U_p \subset \Real^n$，および開集合$V_p \subset \Real^n$ならびに微分同相写像$h_p \colon U_p \to V_p$が存在して，$h_p(U_p \cap M) = V_p \cap \left(\Hyp^k \times \set{0}\right)$，すなわち$h_p(U_p \cap M) = \set{y \in V_p | y^k \geq 0, y^{k+1} = \dots = y^n = 0}$が成り立ち，更に$h_p(p)$の第$k$成分は0である．
\end{enumerate}
上の条件のうち (ii) を充たすような点全体のことを$\partial M$と書いて，$M$のふち，または境界という．定義の (ii) にある$h_p$の存在より，$\partial M$が$k-1$次元多様体であることがわかる．
\end{defi}

\begin{prop}
$M$をふち付き多様体とする．このとき，各点$p \in M$は上記の条件 (i) または (ii) のどちらかしか充たさない．言い換えると，(i) ならびに (ii) を同時に充たす$p \in M$は存在しない．
\end{prop}

\begin{proof}
背理法による．$p \in M$が (i) と (ii) を同時に充たすとして，(i) にあるような微分同相$h_1 \colon U \to V_1$ならびに (ii) にあるような微分同相$h_2 \colon U \to V_2$をとる．$g_1 \coloneqq (h_1^1,\dots, h_1^k)$，$g_2 \coloneqq (h_2^1, \dots, h_2^k)$によって$g_1 \colon U \to \Real^k$，$g_2 \colon U \to \Hyp^k$を定めると，$g_2 \circ g_1^{-1}$は$g_1(p)$を含む$\Real^k$の開集合を$\Hyp^k$の部分集合（とくに$\Real^k$の開集合ではない）にうつす．ところが$\det D_{g_2 \circ g_1^{-1}}(g_1(p)) \neq 0$なので，これは逆写像定理に反する．
\end{proof}

\subsection{多様体上のベクトル場と微分形式}

ベクトル場ならびに微分形式の定義を多様体まで拡張する．とはいえ，多様体になったことで話が変わる部分はそう大きくない．以下しばらく，$M$を$k$次元多様体とする．

\begin{defi}
$p \in M$とし，$f \colon V_p \to \Real^k$を$p$のまわりの座標系，$g \colon f(V_p) \to \Real^n$をその逆写像とする．座標系の定義より，$g$の Jacobi 行列の階数は$k$であるから，特にその微分$dg_{f(p)} \colon T_{f(p)}(f(V_p)) \to T_p \Real^n$の像は$T_p \Real^n$の$k$次元部分線型空間をなす．この像$\Image dg_{f(p)}$のことを$T_pM$と書いて，$M$の$p$における接空間という．$T_pM$の元のことを$M$の$p$における接ベクトルという．

$TM \coloneqq \bigcup_{p \in M} T_pM$を$M$の接ベクトル束という．$X \colon M \to TM$が$M$上のベクトル場であるとは，$X(p) \coloneqq X_p$が$T_pM$の元であることをいう．
\end{defi}

ベクトル場は，必ずしも$M$全域で定義されている必要はない．特に，ベクトル場として$p \in M$のまわりの座標系$y \colon V_p \to \Real^k$を考えて，$V_p$上でのみ定義されたものを考えることがある．そのようなベクトル場のことは「$p$のまわりで定義されたベクトル場」のように言うことにする．

\begin{defi}
$p \in M$とし，$y \colon V_p \to \Real^k$を$p$のまわりの座標系とする．このとき，$p$のまわりで定義されたベクトル場$\frac{\partial}{\partial y^i}$を次のように定める；$y$の逆写像を$z \colon y(V_p) \to V_p$とし，$\Real^k$に標準座標から定まるベクトル場を$\frac{\partial}{\partial x^i}$と書く．このとき，$\left( \frac{\partial}{\partial y^i} \right)_p \coloneqq dz_p \left(\frac{\partial}{\partial x^i} \right)_{y(p)}$と定める．$z$の Jacobi 行列の階数が$k$であることから，$\left\{\left(\frac{\partial}{\partial y^1}\right)_p, \dots, \left(\frac{\partial}{\partial y^k}\right)_p\right\}$は$T_pM$の基底をなす．
\end{defi}

この定義から，自動的に$\frac{\partial}{\partial y^i}$は$f \colon V_p \to \Real$に対する微分作用素となる．具体的に作用を書き下せば，
\begin{equation}
\left( \frac{\partial}{\partial y^i} \right)_p f = dz_p \left(\frac{\partial}{\partial x^i} \right)_{y(p)} f = \left(\frac{\partial}{\partial x^i} \right)_{y(p)} (f \circ z) = \partial_i  (f \circ z) (y(p)) = \partial_i  (f \circ y^{-1}) (y(p))
\end{equation}となる．この作用は，\cref{Euclid空間での座標系から定まるベクトル場}における定義と酷似していることに気づかれたい\footnote{というか，ここの定義から逆算して Euclid 空間の場合を定義した，というのが実際のところである．}．座標変換則もまた，Euclid 空間の場合と同様にして得られる．

\begin{prop}
$y=(y^1, \dots, y^n)$ならびに$z = (z^1,\dots, z^n)$を$U \subset M$上の座標系とする．このとき，
\begin{equation}
\left( \frac{\partial}{\partial z^i} \right)_p = \sum_{j} \left( \frac{\partial }{\partial z^i} y^j \right) (p) \cdot \left( \frac{\partial}{\partial y^j} \right)_p
\end{equation}が成り立つ．したがって，ベクトル場の変換則は
\begin{equation}
\frac{\partial}{\partial z^i} = \sum_{j} \frac{\partial y^j}{\partial z^i} \frac{\partial}{\partial y^j}
\end{equation}と書ける．
\end{prop}

微分形式ならびに関係する概念の定義，および基本性質たちも，Euclid 空間の場合と同様にして話が進む．あらわれる証明も Euclid 空間の場合と同様な（はずな）ので，すべて省略する．

\begin{defi}
$p \in M$に対して，$T_pM$の双対空間$(T_pM)^*$のことを$T_p^*M$と書いて，$p$における余接空間という．$T_p^*M$も線型空間の構造を持つ．
更に，$y$の定めるベクトル場は$T_pM$の基底$\left\{ \left(\frac{\partial}{\partial y^i}\right)_p,\dots, \left(\frac{\partial}{\partial y^i}\right)_p \right\}$を定めた．この基底に関する双対基底を$\left\{ (dy^1)_p,\dots, \left(dy^n\right)_p \right\}$と書く．
\end{defi}

\begin{defi}
$y \colon U \to \Real^k$を$M$上の座標系とする．自然数$k \geq 1$に対して$\omega \colon U \to \bigcup_{p \in M} \GrassAlg^k(T_p^*M)$が$U$上の微分$k$-形式，あるいは単に$k$-形式であるとは，任意の$p \in U$に対して$\omega_p \coloneqq \omega(p) \in \GrassAlg^k(T_p^*M)$となることをいう．また，（滑らかな）関数$f \colon U \to \Real$のことを微分0-形式ともいう．$U$上の微分$k$-形式全体の集合を$\DiffForm^k(U)$と書く．$\omega \in \DiffForm^k(U)$の関数倍$f\omega$のことを$f \wedge \omega$とも書く．
\end{defi}

\begin{defi}
$\omega$を$U$上の$k$-形式とする．このとき，任意の$p \in U$に対して$\left\{ \left( dy^{i_1} \right)_p \wedge \dots \wedge \left( dy^{i_k} \right)_p \ \mid \ 1 \leq i_1 < \dots < i_k \leq n \right\}$は$\bigwedge^k T^*_pM$の基底をなすので，$(i_1, \dots, i_k)$で添字付けられたある関数の族$\set{ f^y_{i_1,i_2,\dots,i_n} \colon U \to \Real | 1 \leq i_1 < \dots < i_k \leq n }$が一意的に存在して，
\begin{equation}
\omega_p = \sum_{1 \leq i_1 < i_2 < \dots i_k \leq n} {f^y_{i_1,i_2,\dots,i_n}}(p) \cdot \left( dy^{i_1} \right)_p \wedge \dots \wedge \left( dy^{i_k} \right)_p
\end{equation}が成り立つ．このような表示のことを$y$による$\omega$の（局所）座標表示と呼ぶ．$\omega$が$C^\infty$級，あるいは滑らかであるとは，すべての$f^y_{i_1,i_2,\dots,i_n}$が$C^\infty$級であることと定める．
\end{defi}

\begin{prop}
$y=(y^1, \dots, y^n)$ならびに$z = (z^1,\dots, z^n)$を$U \subset M$上の座標系とする．このとき，
\begin{equation}
\left(dz^i\right)_p = \sum_{j} \left( \frac{\partial }{\partial y^j} z^i \right) (p) \cdot \left( dy^j \right)_p
\end{equation}が成り立つ．したがって微分1-形式の変換則は
\begin{equation}
dz^i = \sum_{j} \frac{\partial z^i}{\partial y^j} dy^j
\end{equation}と書ける．
\end{prop}

\begin{prop}
$y=(y^1, \dots, y^n)$ならびに$z = (z^1,\dots, z^n)$を$U \subset M$上の座標系とする．このとき，$1 \leq i_1 < \dots < i_k \leq n$を充たすような$(i_1, \dots, i_k)$に対して
\begin{equation}
\left(dy^{i_1} \right)_p \wedge \dots \wedge \left(dy^{i_k} \right)_p = \sum_{1 \leq j_1 < \dots < j_k \leq n} \det \left( \frac{\partial y^{i_a}}{\partial z^{j_b}} \right) (p) \cdot \left( dz^{j_1} \right)_p \wedge \dots \wedge \left( dz^{j_k} \right)_p
\end{equation}が成り立つ．但し，$\left( \frac{\partial y^{i_a}}{\partial z^{j_b}} \right)$は$(a,b)$成分が$\frac{\partial y^{i_a}}{\partial z^{j_b}}$であるような$k \times k$行列をあらわす．特に$n$-形式の場合は記述が少し簡単になり，
\begin{equation}
\left(dy^1 \right)_p \wedge \dots \wedge \left(dy^n \right)_p = \det \left( \frac{\partial y^i}{\partial z^j} \right) (p) \cdot \left( dz^1 \right)_p \wedge \dots \wedge \left( dz^n \right)_p
\end{equation}が成り立つ．
\end{prop}

\begin{defi}$\omega \in \DiffForm^n(U)$とし，その座標表示
\begin{equation}
\omega_p = \sum_{1 \leq i_1 < i_2 < \dots < i_k \leq n} {f^y_{i_1,i_2,\dots,i_k}}(p) \cdot \left( dy^{i_1} \right)_p \wedge \dots \wedge \left( dy^{i_k} \right)_p
\end{equation}を考える．このもとで，$\omega$の外微分$d \omega \in \DiffForm^{n+1}(U)$を，
\begin{equation}
d\omega_p \coloneqq \sum_{1 \leq i_1 < i_2 < \dots < i_k \leq n} \left(df^y_{i_1,i_2,\dots,i_k}\right)_p \wedge \left( dy^{i_1} \right)_p \wedge \dots \wedge \left( dy^{i_k} \right)_p
\end{equation}
によって定める．
\end{defi}

\begin{prop}[外微分の基本性質] $\omega \in \DiffForm^k(U)$，$\eta \in \DiffForm^\ell(U)$とする．
\begin{enumerate}
\item $k=\ell$のとき，$\dif (\omega + \eta) = \dif \omega + \dif \eta$．
\item $\dif (\omega \wedge \eta) = (\dif \omega) \wedge \eta + (-1)^k \omega \wedge \dif \eta$．
\item $\dif (\dif \omega) = 0$．$\dif^2 = 0$と書く場合も多い．
\end{enumerate}
\end{prop}

\begin{defi}$M$，$N$を多様体とし，$y \colon U \to \Real^k$を$N$の座標系とする．このとき，$\omega \in \DiffForm^k(U)$の$f \colon M \to N$による引き戻し$f^* \omega \in \DiffForm^k(f^{-1}(U))$を，$v_1, \dots, v_k \in T_pM$に対して
\begin{equation}
(f^* \omega)_p (v_1, \dots, v_k) \coloneqq \omega_{f(p)} (\dif f_p v_1, \dots, \dif f_p v_k)
\end{equation}とすることで定める．
\end{defi}

\begin{prop}[引き戻しの基本性質] $\omega \in \DiffForm^k(U)$，$\eta \in \DiffForm^\ell(U)$，$U \subset N$を開集合とし，$f \colon M \to N$とする．
\begin{enumerate}
\item $k = \ell$のとき，$f^*(\omega + \eta) = f^* \omega + f^* \eta$．
\item $f^*(\omega \wedge \eta) = f^* \omega \wedge f^* \eta$．
\item $f^*(\dif \omega) = \dif (f^*(\omega))$．
\end{enumerate}
\end{prop}

\subsection{多様体の向き}

\subsection{Stokes の定理}

\subsection{Riemann 計量と体積形式}

\subsection{古典ベクトル解析の諸定理}
